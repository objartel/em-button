<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookie Clicker</title>
    
    <!-- PostHog Analytics -->
    <script>
        !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))} }(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init Re Os As Pe Ms Fs capture Ve calculateEventProperties js register register_once register_for_session unregister unregister_for_session qs getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSurveysLoaded onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey canRenderSurveyAsync identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty zs Ls createPersonProfile Us Rs Bs opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing Ds debug I Ns getPageViewId captureTraceFeedback captureTraceMetric".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
        posthog.init('phc_SCMTYgrWdLeEHjj1bVLF9qAAOjliZZmRIMT8sfGm5eo', {
            api_host: 'https://eu.i.posthog.com',
            defaults: '2025-05-24',
            person_profiles: 'identified_only'
        });
    </script>

<!-- Hotjar Tracking Code for cookie -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:6475508,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
    
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        height: 100vh;
        background: linear-gradient(135deg, #f4e4bc, #d4b896);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        font-family: 'Arial', sans-serif;
        overflow: hidden;
    }

    .game-container {
        text-align: center;
        position: relative;
    }

    .click-counter {
        font-size: 2.5rem;
        font-weight: bold;
        color: #8B4513;
        margin-bottom: 30px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        user-select: none;
    }

    .cookie-button {
        width: 276px;
        height: 276px;
        border: none;
        background: none;
        cursor: pointer;
        position: relative;
        transition: transform 0.1s cubic-bezier(.4,2,.6,1);
        will-change: transform;
        user-select: none;
        /* Safari-specific fixes */
        -webkit-user-select: none;
        -webkit-touch-callout: none;
        -webkit-tap-highlight-color: transparent;
        padding: 0;
        outline: none;
        /* Safari hardware acceleration fixes */
        -webkit-backface-visibility: hidden;
        -webkit-transform-style: preserve-3d;
        transform: translate3d(0,0,0);
        -webkit-transform: translate3d(0,0,0);
        /* Mobile Safari touch fixes */
        touch-action: manipulation;
        -webkit-appearance: none;
    }

    .cookie-image {
        width: 100%;
        height: 100%;
        object-fit: contain;
        pointer-events: none;
        user-select: none;
        -webkit-user-select: none;
        display: block;
        /* Safari hardware acceleration for image */
        -webkit-backface-visibility: hidden;
        transform: translate3d(0,0,0);
        -webkit-transform: translate3d(0,0,0);
    }

    .cookie-button:focus {
        outline: 3px solid #8B4513;
        outline-offset: 4px;
    }

    .emoji-burst {
        position: absolute;
        pointer-events: none;
        font-size: 2.4rem;
        z-index: 1000;
        transition: all 0.8s ease-out;
        opacity: 1;
        transform: translate(-50%, -50%) scale(0.5) translate3d(0,0,0);
        /* Safari hardware acceleration for emoji */
        -webkit-backface-visibility: hidden;
        -webkit-transform: translate(-50%, -50%) scale(0.5) translate3d(0,0,0);
    }

    @keyframes burst {
        0% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(0);
        }
        50% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1.2);
        }
        100% {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.8);
        }
    }

    /* Ensure the cookie gets smaller with each click */
    .cookie-shrink {
        transform: translate3d(0,0,0) scale3d(0.9, 0.9, 1);
        -webkit-transform: translate3d(0,0,0) scale3d(0.9, 0.9, 1);
    }
</style>
</head>
<body>
<div class="game-container">
    <div class="click-counter" id="clickCounter">Clicked 0 times</div>
    
    <button class="cookie-button" id="cookieButton">
        <img src="https://raw.githubusercontent.com/objartel/em-button/main/cookie.png" alt="Cookie" class="cookie-image">
    </button>
</div>

<script>
    let clickCount = 0;
    const cookieButton = document.getElementById('cookieButton');
    const clickCounter = document.getElementById('clickCounter');

    function updateCounter() {
        clickCounter.textContent = `Clicked ${clickCount} times`;
    }

    function createEmojieBurst(centerX, centerY) {
        const numEmojis = 6 + Math.floor(Math.random() * 6); // Random number between 6-11
        
        for (let i = 0; i < numEmojis; i++) {
            const emoji = document.createElement('div');
            emoji.className = 'emoji-burst';
            emoji.textContent = '🍪';
            
            // Start at center
            emoji.style.left = centerX + 'px';
            emoji.style.top = centerY + 'px';
            
            document.body.appendChild(emoji);
            
            // Calculate random direction for burst
            const angle = Math.random() * 360; // Completely random angle
            const distance = 80 + Math.random() * 100; // Random distance between 80-180px
            const radians = (angle * Math.PI) / 180;
            const offsetX = Math.cos(radians) * distance;
            const offsetY = Math.sin(radians) * distance;
            
            // Add slight random delay for more natural burst effect
            const delay = Math.random() * 100;
            
            // Animate from center to final position
            setTimeout(() => {
                emoji.style.left = (centerX + offsetX) + 'px';
                emoji.style.top = (centerY + offsetY) + 'px';
                emoji.style.opacity = '0';
                const rotation = Math.random() * 720 - 360; // Random rotation between -360 and 360 degrees
                emoji.style.transform = `translate(-50%, -50%) scale(1.5) rotate(${rotation}deg) translate3d(0,0,0)`;
                emoji.style.webkitTransform = `translate(-50%, -50%) scale(1.5) rotate(${rotation}deg) translate3d(0,0,0)`;
            }, 50 + delay);
            
            // Remove emoji after animation
            setTimeout(() => {
                if (emoji.parentNode) {
                    emoji.parentNode.removeChild(emoji);
                }
            }, 1000 + delay);
        }
    }

    function shrinkCookie() {
        // Add the shrink class to trigger the scale down
        cookieButton.classList.add('cookie-shrink');
        
        // Remove the class exactly after 100ms like in your document
        setTimeout(() => {
            cookieButton.classList.remove('cookie-shrink');
        }, 100);
    }

    cookieButton.addEventListener('click', function(event) {
        // Skip if already handled by touch events
        if (touchHandled) {
            touchHandled = false;
            return;
        }
        
        clickCount++;
        updateCounter();
        
        // Get click position relative to the viewport
        const rect = cookieButton.getBoundingClientRect();
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;
        
        // Create emoji burst
        createEmojieBurst(centerX, centerY);
        
        // Shrink the cookie
        shrinkCookie();
        
        // Send event to PostHog
        if (typeof posthog !== 'undefined') {
            posthog.capture('cookie_clicked', {
                click_count: clickCount,
                input_method: 'mouse',
                timestamp: Date.now()
            });
        }
        
        // Prevent default behavior for Safari
        event.preventDefault();
    });

    // Prevent context menu on long press for mobile Safari
    cookieButton.addEventListener('contextmenu', function(event) {
        event.preventDefault();
    });

    // Mobile Safari touch handling
    let touchHandled = false;
    
    cookieButton.addEventListener('touchstart', function(event) {
        event.preventDefault();
        touchHandled = false;
    });

    cookieButton.addEventListener('touchend', function(event) {
        event.preventDefault();
        
        if (!touchHandled) {
            touchHandled = true;
            
            // Handle the click action
            clickCount++;
            updateCounter();
            
            // Get button center position
            const rect = cookieButton.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            // Create emoji burst
            createEmojieBurst(centerX, centerY);
            
            // Shrink the cookie
            shrinkCookie();
            
            // Send event to PostHog
            if (typeof posthog !== 'undefined') {
                posthog.capture('cookie_clicked', {
                    click_count: clickCount,
                    input_method: 'touch',
                    timestamp: Date.now()
                });
            }
        }
    });

    cookieButton.addEventListener('touchcancel', function(event) {
        touchHandled = false;
    });

    // Keyboard navigation event tracking
    cookieButton.addEventListener('keydown', function(event) {
        if (event.key === ' ' || event.key === 'Enter') {
            event.preventDefault();
            
            clickCount++;
            updateCounter();
            
            // Get button center position
            const rect = cookieButton.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            // Create emoji burst
            createEmojieBurst(centerX, centerY);
            
            // Shrink the cookie
            shrinkCookie();
            
            // Send event to PostHog
            if (typeof posthog !== 'undefined') {
                posthog.capture('cookie_clicked', {
                    click_count: clickCount,
                    input_method: 'keyboard',
                    key: event.key,
                    timestamp: Date.now()
                });
            }
        }
    });

    // Initialize the game
    updateCounter();
</script>
</body>
</html>